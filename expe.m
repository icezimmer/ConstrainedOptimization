%{
res=[0.1487,0.4491,0.3029,0.2139,1.1311,118.4613;
    0.0216,0.0350,0.0295,0.0210,0.3000,79.1136;
    15.0472,262.1471,77.8022,49.0801,0.8099,117.0301;
    0.7296,9.1291,1.7699,1.2206,0.2140,85.9421;
    0.0891,0.3970,0.2459,0.1665,0.7318,130.3453;
    0.0118,0.0219,0.0141,0.0083,0.1736,93.4334;
    12.9171,260.7508,63.0172,38.9756,0.6631,148.7174;
    0.3804,10.0570,1.1279,0.8340,0.1815,96.6552;
    2.5564,7.7800,4.3553,3.2690,1.3405,14.1575;
    1.8693,2.1110,0.7498,0.7613,0.3037,13.7102;
    119.0763,348.0407,303.4168,224.1780,0.8359,9.2593;
    78.3439,85.2961,83.1392,81.1559,0.2283,5.6024;
    1.9178,5.8554,3.8930,2.8336,0.9357,17.6365;
    1.4512,1.6610,0.7492,0.6984,0.3260,18.1085;
    121.1487,364.4806,315.1794,230.1541,0.7846,13.0474;
    78.4719,86.1408,84.3725,82.7169,0.2486,11.8179];
path = fullfile('results', 'res.mat');
save(path, "res");

%3LBM,4LBM,7LBM,8LBM,11(def,LBM,QBM,NM),12(def,LBM,QBM,NM),15(def,LBM,QBM,NM),16(def,LBM,QBM,NM)
%{
def_conv_m = mean(res([1:10,13:14], 1))
def_conv_v = var(res([1:10,13:14], 1))
LBM_conv_m = mean(res([1,2,5,6,9,10,13,14], 2))
LBM_conv_v = var(res([1,2,5,6,9,10,13,14], 2))
QBM_conv_m = mean(res([1:10,13:14], 3))
QBM_conv_v = var(res([1:10,13:14], 3))
NM_conv_m  = mean(res([1:10,13:14], 4))
NM_conv_v  = var(res([1:10,13:14], 4))
int_conv_m = mean(res(:,5))
int_conv_v = var(res(:,5))
act_conv_m = mean(res(:,6))
act_conv_v = var(res(:,6))
%}

%{
def_conv_m = mean(res([1,2,5,6], 1))
def_conv_v = var(res([1,2,5,6], 1))
LBM_conv_m = mean(res([1,2,5,6], 2))
LBM_conv_v = var(res([1,2,5,6], 2))
QBM_conv_m = mean(res([1,2,5,6], 3))
QBM_conv_v = var(res([1,2,5,6], 3))
NM_conv_m  = mean(res([1,2,5,6], 4))
NM_conv_v  = var(res([1,2,5,6], 4))
int_conv_m = mean(res([1,2,5,6],5))
int_conv_v = var(res([1,2,5,6],5))
act_conv_m = mean(res([1,2,5,6],6))
act_conv_v = var(res([1,2,5,6],6))
%}

%{
int_conv_m = mean(res([11,12,15,16],5))
int_conv_v = var(res([11,12,15,16],5))
act_conv_m = mean(res([11,12,15,16],6))
act_conv_v = var(res([11,12,15,16],6))
%}

def_conv_m = mean(res([3,4,7,8,9,10,13,14], 1))
def_conv_v = var(res([3,4,7,8,9,10,13,14], 1))
LBM_conv_m = mean(res([9,10], 2))
LBM_conv_v = var(res([9,10], 2))
QBM_conv_m = mean(res([3,4,7,8,9,10,13,14], 3))
QBM_conv_v = var(res([3,4,7,8,9,10,13,14], 3))
NM_conv_m  = mean(res([3,4,7,8,9,10,13,14], 4))
NM_conv_v  = var(res([3,4,7,8,9,10,13,14], 4))
int_conv_m = mean(res([3,4,7,8,9,10,13,14],5))
int_conv_v = var(res([3,4,7,8,9,10,13,14],5))
act_conv_m = mean(res([3,4,7,8,9,10,13,14],6))
act_conv_v = var(res([3,4,7,8,9,10,13,14],6))
%}
t=[0.003315000000000,0.016941000000000,0.225496000000000,1.981332000000000,7.563633000000000,17.862125000000000,30.819568000000000,46.077781000000000];
s=[3,13,255,2344,9156,21891,38386,56459];

figure;
plot(t,'-sb');
title('Elapsed time');
xticklabels({'1e-3','1e-4','1e-5','1e-6','1e-7','1e-8','1e-9','1e-10'})
xlabel('\epsilon_R')
ylabel('second')

figure;
plot(s,'-sk');
title('Number of iterations');
xticklabels({'1e-3','1e-4','1e-4','1e-5','1e-6','1e-7','1e-8','1e-9','1e-10'})
xlabel('\epsilon_R')
ylabel('iteration')